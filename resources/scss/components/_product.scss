@use "../abstracts" as *;

.product {
    display: grid;
    grid-template-columns: minmax(0, 1fr);
    grid-template-areas: 
        "header"
        "media"
        "info"
        "action"
        "related"
        "reviews";
    gap: $size-2;

    &__header {
        grid-area: header;

        .name {
            margin-block: $size-2;
            font-size: $font-size-800;
            color: $color-primary-800;
            font-family: $font-family-semibold;
        }

        .reviews-summary {
            margin-block-end: $size-2;
            font-size: $font-size-600;
            color: $color-secondary-600;
        }
    }

    &__media {
        grid-area: media;
        min-width: 0;

        .featured-img {
            height: 400px;

            img {
                margin-inline: auto;
                height: 100%;
                width: auto;
                object-fit: contain;
                display: block;
                cursor: zoom-in;
            }
        }

        .featured-modal {
            position: fixed;
            inset: 0;
            background: rgb(0, 0, 0, 0.8);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 50;

            .current-img {
                width: 90vw;
                height: auto;
                max-height: 75vh;
                object-fit: contain;
                cursor: zoom-out;
                transition: transform 0.3s ease;
            }
        }

        .track-wrap {
            position: relative;

            @include mq(extraLarge) {
                margin-inline: $size-10;
            }

            .ui-icon-btn {
                position: absolute;
                top: 50%;
                transform: translateY(-50%);
                z-index: 10;
                display: none;

                @include mq(medium) {
                    display: block;
                }
            }

            .ui-icon-btn.prev { left: .25rem; }
            .ui-icon-btn.next { right: .25rem; }
        }

        .track {
            display: flex;
            overflow-x: auto;
            overflow-y: hidden;
            gap: $size-4;
            padding-block: $size-4;
            -webkit-overflow-scrolling: touch;
            overscroll-behavior-x: contain;
            scrollbar-width: none;

            &::-webkit-scrollbar { display: none; }

            &__item {
                border: 2px solid transparent;
                flex: 0 0 89px;
                inline-size: clamp(96px, 35vw, 160px);
                aspect-ratio: 1 / 1;
                scroll-snap-align: start;
                min-width: 0;
                cursor: pointer;

                &.is-checked {
                    border-color: $color-primary-600;
                    box-shadow: 0 0 0 2px rgba($color-primary-400, .25);
                }

                &:hover { border-color: $color-primary-600; }
                &:disabled { cursor: not-allowed; opacity: .5; }
            }

            img {
                display: block;
                inline-size: 100%;
                block-size: 100%;
                object-fit: cover;
            }
        }
    }

    &__info {
        min-width: 0;
        grid-area: info;
        margin-block-start: $size-8;
        
        .variants {
            display: flex;
            flex-wrap: nowrap;
            overflow-x: auto;
            gap: $size-2;
            min-width: 0;
            overscroll-behavior-x: contain;
            touch-action: pan-x;
            -webkit-overflow-scrolling: touch;
            scrollbar-width: none;

            &::-webkit-scrollbar { display: none; }

            .variant {
                flex: 0 0 auto;
                min-width: 0;
                min-inline-size: 96px;
                box-sizing: border-box;
                position: relative;
                scroll-snap-align: start;
                
                &__input {
                    position: absolute;
                    opacity: 0;
                    inset: 0;
                    pointer-events: none;

                    &:focus-visible + .variant__label {
                        outline: 2px solid Highlight;
                        outline-offset: 2px;
                    }
                }

                &__label {
                    display: inline-flex;
                    justify-content: center;
                    line-height: 1.2;
                    width: 100%;
                    padding: $size-3;
                    border: 1px solid $color-primary-500;
                    border-radius: $border-radius-1;
                    white-space: nowrap;
                    cursor: pointer;
                    transition: border-color .2s, background-color .2s, box-shadow .2s, color .2s;
                    user-select: none;
                }

                &__input:checked + .variant__label {
                    border-width: 2px;
                    border-color: $color-primary-800;
                    background: $color-primary-100;
                    color: $color-primary-900;
                    box-shadow: 0 0 0 2px rgba($color-primary-400, .15);
                }

                 &__input:not(:checked) + .variant__label:hover {
                    border-color: $color-primary-800;
                    transition: 250ms ease;
                }

                &__input:disabled + .variant__label {
                    color: $color-neutral-500;
                    border-color: $color-neutral-200;
                    background: $color-neutral-100;
                    text-decoration: line-through;
                    cursor: not-allowed;
                }
            }
        }

        .price {
            margin-block: $size-6;
            color: $color-primary-900;
            font-size: $font-size-800;
            
            &__original {
                color: #B03030;
                text-decoration: line-through;
                text-decoration-thickness: .12em;
                text-decoration-color: currentColor;
                text-decoration-skip-ink: none;
                font-size: $font-size-600;                
            }
        }

        .coupon {
            &__zone {
                display: flex;
                align-items: stretch;
                gap: $size-4;
                padding-block: $size-2;

                input {
                    flex: 1;
                    border: 1px solid $color-neutral-500;
                    display: block;
                    width: 100%;
                }

                .button {
                    display: block;
                    height: auto;
                }
            } 
        }

        .details {
            .tabs {
                white-space: nowrap;
                display: flex;
                overflow-x: auto;
                gap: $size-4;
                scrollbar-width: none;
                -ms-overflow-style: none;

                @include mq(large) {
                    display: none;
                }

                &--active {
                    background: $color-primary-300;
                    color: $color-primary-900;
                    font-family: $font-family-semibold;
                    border: 2px solid $color-primary-900;
                }
            }

            .content {
                margin-block: $size-4;

                &__section {
                    .subheader {
                        display: none;
                    }

                    @include mq(large) {
                        margin-block-end: $size-6;

                        .subheader {
                            display: block;
                        }
                    }
                }
            }
        }
    }
    
    &__action {
        grid-area: action;
        margin-block-start: $size-8;
        margin-block-end: $size-8;

        .price {
            display: none;
        }

        .stock {
            font-size: $font-size-500;
        }
        
        .quantity {
            margin-block: $size-4;
            display: flex;
            flex-direction: column;
            gap: $size-2;

            .quantity-trigger {
                display: flex;
                align-items: center;
                justify-content: space-between;
                padding: $size-2 $size-3;
                cursor: pointer;
            }

            .quantity-modal {
                position: fixed;
                inset: 0;
                z-index: 50;

                &__backdrop {
                    background: rgb(0 0 0 / 0.3);
                    position: absolute;
                    inset: 0;
                }

                &__content {
                    position: absolute;
                    left: 50%;
                    top: 20%;
                    width: 50%;
                    transform: translateX(-50%);
                    background: $color-neutral-100;
                    border-radius: $border-radius-1;
                    width: min(55vw, 22rem);
                    overflow: hidden;

                    .controls {
                        display: flex;
                        align-items: center;
                        justify-content: space-between;
                        padding: $size-4;
                        background: $color-neutral-200;
                    }
                    
                    .list-options {
                        max-height: 60vh;
                        overflow: auto;

                        li {
                            border-bottom: 1px solid $color-neutral-200;
                            
                            &:last-child {
                                border-bottom: none;
                            }

                            > .list-options__button {
                                display: block;
                                width: 100%;
                                text-align: left;
                                padding: $size-2 $size-4;
                                cursor: pointer;
                                border: none;

                                &--checked {
                                    border: 1px solid $color-primary-800;
                                    border-left: 4px solid $color-primary-800;
                                }
                            }
                        }
                    }
                }
            }
        }

        .coupon {
            margin-block-start: $size-6;
            
            &__zone {
                input {
                    margin-block: $size-3;
                    width: 100%;
                }

                .button[data-type="coupon"] {
                    width: 100%;

                    &:hover {
                        background: $color-primary-600;
                        color: $color-neutral-100;
                    }
                }
            }
        }
        
        .button[data-type="cart"] {
            width: 100%;
        }
    }

    &__reviews {
        grid-area: reviews;
        margin-block: $size-8;

        .header {
            font-size: $font-size-600;
            font-family: $font-family-semibold;
            color: $color-primary-900;
            padding-block: $size-4;
            text-align: center;
        }

        .review {
            margin-block: $size-4;

            .stars {
                margin-block-end: $size-1;
                font-size: 20px;
            }

            .author {
                font-family: $font-family-semibold;
                color: $color-neutral-900;
            }

            .text {
                font-size: $font-size-500;
                line-height: 1.4;
            }
        }
    }

    hr {
        margin-inline: -1rem;

        &[data-device="d"] {
            display: none;
        }

        &[line-type="base"] {
            border: 2px solid $color-primary-300;        
        }

        &[line-type="inner"] {
            border: 1px solid $color-primary-300;
        }
    }

    @include mq(medium) {
        grid-template-columns: minmax(280px, 377px) minmax(0,1fr);
        grid-template-rows: auto 1fr auto;
        gap: $size-4;
        grid-template-areas: 
            "media header"
            "media info"
            "media action"
            "reviews reviews";
        
        &__media {
            margin-block: 0;

            .track {
                margin-inline: auto;
            }
            
            img {
                width: clamp(280px, 40vw, 337px);
                height: auto;
                display: block;
            }
        }

        &__header {
            .name {
                margin-block: 0;
                font-size: $font-size-700;
                font-family: $font-family-semibold;
            }

            .reviews-summary {
                margin-block-end: 0;
            }
        }

        &__info {
            margin-block-start: 0;
            display: flex;
            flex-direction: column;

            .price {
                margin-block: 0;
                order: 1;

                &__final {
                    font-size: $font-size-700;
                }
            }

            .variants {
                order: 2;
                flex-wrap: wrap;
                margin-block: $size-4;
                overflow-x: visible;
                
                .variant {
                    max-inline-size: 100%;

                    &__label {
                        padding: $size-2;
                        white-space: normal;
                        overflow-wrap: anywhere;
                    }
                }
            }

            .details {
                order: 4;
                margin-block: 0;

                .content {
                    margin-block-start: $size-4;
                    margin-block-end: 0;
                }
            }
        }

        &__action {
            margin-block-start: $size-4;

            .stock {
                font-size: $font-size-400;
            }
            
            .quantity {
                order: 3;
               
                .quantity-trigger {
                    padding: $size-1 $size-2;
                }
            }
        }

        &__reviews {
            grid-area: reviews;
            
            .header {
                text-align: start;
            }
        }

        hr[data-device="m"] {
            display: none;
        }
    }

    @include mq(large) {
        gap: $size-2 $size-10;
        grid-template-columns: minmax(360px, 1fr) minmax(0,1fr) 320px;
        grid-template-areas: 
            "media   header   action"
            "media   info     action"
            "media   related  action"
            "reviews reviews  .";
    
        hr[data-device="d"] {
            display: block;
            margin-inline: 0;
            margin-block: $size-2;
        }

        &__media {
            align-self: start;
            height: 100%;

            .featured-img {
                img {
                    display: block;
                    width: 100%;
                    height: 100%;
                    object-fit: contain;
                }
            }

            .track {
                // width: clamp(280px, 40vw, 337px);
                margin-inline: $size-10;

                img {
                    display: block;
                    height: 100%;
                }
            }
        }
        
        &__action {
            outline: 1px solid $color-primary-300;
            border-radius: $border-radius-1;
            top: $size-4;
            padding: $size-5;

            .price {
                display: block;
                font-size: $font-size-700;
                color: $color-neutral-900;
            }

            .coupon {
                .button[data-type="coupon"] {
                    background: transparent;
                    color: $color-primary-600;
                    border: 2px solid $color-primary-600;
                }
            }
        }
    }
}